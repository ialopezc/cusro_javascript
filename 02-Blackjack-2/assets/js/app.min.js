// Isaac Alejandro López Castrejón 2023
const moduleGame=(()=>{"use strict";let e,l,t,a,s=["C","D","H","S"],d=["A","J","Q","K"],r=document.querySelector("#btnNewGame"),i=document.querySelector("#btnRequestCard"),n=document.querySelector("#btnStop"),c=document.querySelector("#divPlayers");i.disabled=!0,n.disabled=!0;let o=(e=1)=>{i.disabled=!1,c.innerHTML="",console.clear(),$(),l=[];for(let s=0;s<e;s++){l.push(0);let d=document.createElement("div");d.classList.add("col-12"),d.innerHTML=`<h1>Jugador ${s+1} - <small>0</small></h1><div class="divCards"></div>`,c.append(d)}l.push(0);let r=document.createElement("div");r.classList.add("col-12"),r.innerHTML='<h1>Computer - <small>0</small></h1><div class="divCards"></div>',c.append(r),setTimeout(()=>{t=document.querySelectorAll("small"),a=document.querySelectorAll(".divCards")},500)},$=()=>{e=[];for(let l=2;l<=10;l++)for(let t of s)e.push(l+t);for(let a of s)for(let r of d)e.push(r+a);return e=_.shuffle(e)},u=()=>{if(0===e.length)throw"Ya no hay cartas";return e.shift()},m=e=>{let l=e.substring(0,e.length-1);return isNaN(l)?"A"===l?11:10:Number(l)},h=(e,a)=>(l[e]=l[e]+m(a),t[e].innerText=l[e],l[e]),b=(e,l)=>{let t=document.createElement("img");t.src=`assets/img/cartas/${l}.png`,t.classList.add("img-fluid"),t.classList.add("cartas"),a[e].append(t)},p=()=>{let[e,t]=l;setTimeout(()=>{let l=t===e?"Empate!!":e>21&&e>t?"La computadora gana":"Ganaste!";alert(l)},500)},f=e=>{let t;do{let a=u();if(t=h(l.length-1,a),b(l.length-1,a),e>21)break}while(t<e&&e<=21);p()};return i.addEventListener("click",()=>{n.disabled=!1;let e=u(),l=h(0,e);b(0,e),l>21?(i.disabled=!0,n.disabled=!0,f(l)):21===l&&(i.disabled=!0,n.disabled=!0,f(l))}),n.addEventListener("click",()=>{i.disabled=!0,n.disabled=!0,f(l[0])}),r.addEventListener("click",()=>{o()}),{initGame:o}})();